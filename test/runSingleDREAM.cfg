process CaloTest  = {
    
    untracked PSet maxEvents = {untracked int32 input = 10}

    service = MessageLogger	{
        untracked vstring destinations = {"cout", "errors"} 
        untracked vstring categories = { 
            "EcalSim", "G4cout", "G4cerr", "CherenkovAnalysis","CaloSim"
        }
        untracked vstring debugModules = { "*" }

        # Standard out: only our messages
        untracked PSet cout = { 
            untracked string threshold = "INFO"
            untracked PSet default = { untracked int32 limit = 0 }
            untracked PSet EcalSim = { untracked int32 limit = -1} 
            untracked PSet G4cout  = { untracked int32 limit = -1 }
            untracked PSet G4cerr  = { untracked int32 limit = -1 }
#            untracked PSet CherenkovAnalysis = { untracked int32 limit = -1 }
        }
        # Errors: all errors...
        untracked PSet errors = { 
            untracked string threshold = "WARNING"
            untracked PSet default = { untracked int32 limit = -1 }
            untracked PSet CaloSim = { untracked int32 limit = 100 }
        }
    }
    
    include "SimGeneral/HepPDTESSource/data/pdt.cfi"
    service = RandomNumberGeneratorService {
        untracked uint32 sourceSeed = 135799753
        PSet moduleSeeds = {
            untracked uint32 VtxSmeared = 123456789
            untracked uint32 g4SimHits = 9876
        }
    }
    
    #Geometry
    include "SimG4CMS/CherenkovAnalysis/data/SingleDREAMXML.cfi"

    include "SimG4CMS/CherenkovAnalysis/data/gun.cff"
    # 10 degrees
    replace VtxSmeared.MeanX = 0.255674122
    replace FlatRandomEGunSource.PGunParameters.MinPhi = 1.396263401595464
    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 1.396263401595464

    include "SimG4Core/Application/data/g4SimHits.cfi"
    replace g4SimHits.UseMagneticField       = false    
    #	replace g4SimHits.G4Commands ={"/tracking/verbose 1"}
    replace g4SimHits.Physics.type = "SimG4Core/Physics/QGSP"
    replace g4SimHits.ECalSD.UseBirkLaw = false
    replace g4SimHits.ECalSD.SlopeLightYield = 0.0
    
    include "Configuration/EventContent/data/EventContent.cff"
    module o1 = PoolOutputModule {
        using FEVTSIMEventContent
        untracked string fileName = "simevent.root"
    }

    service = TFileService {
        string fileName = "Cherenkov.root"        
    }    

    module analyzer = CherenkovAnalysis {
        InputTag caloHitSource = g4SimHits:EcalHitsEB
        double   maxEnergy   = 2.0
        uint32   nBinsEnergy = 50
    }
    
    path p1 = { VtxSmeared, g4SimHits, analyzer }
    endpath outpath = { o1 }
}		
