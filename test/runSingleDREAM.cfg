process CaloTest  = {
    
    untracked PSet maxEvents = { untracked int32 input = 10 }

    include "Configuration/EventContent/data/EventContent.cff"
    module o1 = PoolOutputModule {
        using FEVTSIMEventContent
        untracked string fileName = "files/simevent-e10-a-0.root"
    }

    service = TFileService {
        string fileName = "files/Cherenkov-e10-a0.root"        
    }    

    include "SimG4CMS/CherenkovAnalysis/data/gun.cff"

    # Electron energy
    replace FlatRandomEGunSource.PGunParameters.MinE   = 10.0
    replace FlatRandomEGunSource.PGunParameters.MaxE   = 10.0

    # 10 degrees
//   replace VtxSmeared.MeanX = -0.158694
//   replace FlatRandomEGunSource.PGunParameters.MinPhi = 1.396263401595464
//   replace FlatRandomEGunSource.PGunParameters.MaxPhi = 1.396263401595464

    # 20 degrees
//    replace VtxSmeared.MeanX = -0.3275732108395821
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 1.221730476396031
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 1.221730476396031

    # 30 degrees
//    replace VtxSmeared.MeanX = -0.5196152422706631
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 1.047197551196598
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 1.047197551196598

    # 40 degrees
//    replace VtxSmeared.MeanX = -0.7551896680595519
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 0.8726646259971648
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 0.8726646259971648
    
    # -10 degrees
//    replace VtxSmeared.MeanX = 0.1586942826376185
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 1.74532925199433
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 1.74532925199433

    # -20 degrees
//    replace VtxSmeared.MeanX = 0.3275732108395821
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 1.919862177193763
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 1.919862177193763

    # -30 degrees
//    replace VtxSmeared.MeanX = 0.5196152422706631
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 2.094395102393195
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 2.094395102393195

    # -40 degrees
//    replace VtxSmeared.MeanX = 0.7551896680595519
//    replace FlatRandomEGunSource.PGunParameters.MinPhi = 2.268928027592628
//    replace FlatRandomEGunSource.PGunParameters.MaxPhi = 2.268928027592628

    service = MessageLogger	{
        untracked vstring destinations = {"cout", "errors"} 
        untracked vstring categories = { 
            "EcalSim", "G4cout", "G4cerr", "CherenkovAnalysis","CaloSim"
        }
        untracked vstring debugModules = { "*" }

        # Standard out: only our messages
        untracked PSet cout = { 
            untracked string threshold = "INFO"
            untracked PSet default = { untracked int32 limit = 0 }
            untracked PSet EcalSim = { untracked int32 limit = -1} 
            untracked PSet G4cout  = { untracked int32 limit = -1 }
            untracked PSet G4cerr  = { untracked int32 limit = -1 }
            untracked PSet CherenkovAnalysis = { untracked int32 limit = -1 }
        }
        # Errors: all errors...
        untracked PSet errors = { 
            untracked string threshold = "WARNING"
            untracked PSet default = { untracked int32 limit = -1 }
            untracked PSet CaloSim = { untracked int32 limit = 100 }
        }
    }
    
    include "SimGeneral/HepPDTESSource/data/pdt.cfi"
    service = RandomNumberGeneratorService {
        untracked uint32 sourceSeed = 135799753
        PSet moduleSeeds = {
            untracked uint32 VtxSmeared = 123456789
            untracked uint32 g4SimHits = 9876
        }
    }
    
    #Geometry
    include "SimG4CMS/CherenkovAnalysis/data/SingleDREAMXML.cfi"

    include "SimG4Core/Application/data/g4SimHits.cfi"
    replace g4SimHits.UseMagneticField       = false    
    #	replace g4SimHits.G4Commands ={"/tracking/verbose 1"}
    replace g4SimHits.Physics.type = "SimG4Core/Physics/QGSP"

    # Replace all of the ECAL sensitive detector configuration
    replace g4SimHits.ECalSD = {
	bool   UseBirkLaw = false
	double BirkC1 = 0.013
	double BirkC2 = 9.6e-6
	bool   BirkL3Parametrization = false
	double BirkSlope = 0.253694
	double BirkCut   = 0.10
	double SlopeLightYield = 0.0
	untracked bool TestBeam = false

        bool doCherenkov = true
    }
    
    module analyzer = CherenkovAnalysis {
        InputTag caloHitSource = g4SimHits:EcalHitsEB
        double   maxEnergy   = 2.0
        uint32   nBinsEnergy = 50
    }
    
    path p1 = { VtxSmeared, g4SimHits, analyzer }
    endpath outpath = { o1 }
}		
