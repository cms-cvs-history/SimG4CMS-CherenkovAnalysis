process CaloTest  = {
    
    untracked PSet maxEvents = { untracked int32 input = 5 }

    include "Configuration/EventContent/data/EventContent.cff"
    module o1 = PoolOutputModule {
        using FEVTSIMEventContent
        untracked string fileName = "simevent_8.root"
    }

    service = TFileService {
        string fileName = "ecHit_8.root"
    }

    service = Timing {}

    source = FlatRandomEGunSource {
       untracked PSet PGunParameters = {
           untracked vint32 PartID = {13}
           untracked double MinEta =  0.
           untracked double MaxEta =  0.
           untracked double MinPhi =  0.
           untracked double MaxPhi =  0.
           untracked double MinE   = 200.0
           untracked double MaxE   = 200.0
       }
       untracked int32 Verbosity = 0 
    }

    module VtxSmeared = GaussEvtVtxGenerator {
       double MeanX = -12.0
       double MeanY = 0.
       double MeanZ = 0.
       double SigmaX = 0.0000
       double SigmaY = 0.0000
       double SigmaZ = 0.0000
       double TimeOffset = 0.
    }

    service = MessageLogger	{
        untracked vstring destinations = {"cout", "errors"} 
        untracked vstring categories = { "EcalSim", "G4cout", "G4cerr", 
                 "CherenkovAnalysis", "SimG4CoreApplication", "CaloSim"
        }
        untracked vstring debugModules = { "*" }

        # Standard out: only our messages
        untracked PSet cout = { 
            untracked string threshold = "DEBUG"
            untracked PSet default = { untracked int32 limit = 0 }
            untracked PSet EcalSim = { untracked int32 limit = -1} 
            untracked PSet G4cout  = { untracked int32 limit = -1 }
            untracked PSet G4cerr  = { untracked int32 limit = -1 }
            untracked PSet CherenkovAnalysis = { untracked int32 limit = -1 }
            untracked PSet SimG4CoreApplication= { untracked int32 limit = -1 }
            untracked PSet CaloSim = { untracked int32 limit = -1 }
        }
        # Errors: all errors...
        untracked PSet errors = { 
            untracked string threshold = "WARNING"
            untracked PSet default = { untracked int32 limit = -1 }
            untracked PSet CaloSim = { untracked int32 limit = 100 }
        }
    }
    
    include "SimGeneral/HepPDTESSource/data/pdt.cfi"
    service = RandomNumberGeneratorService {
        untracked uint32 sourceSeed = 135799760
        PSet moduleSeeds = {
            untracked uint32 VtxSmeared = 123456796
            untracked uint32 g4SimHits = 9883
        }
    }
    
    #Geometry
    include "SimG4CMS/CherenkovAnalysis/data/testMuon.cfi"

    include "SimG4Core/Application/data/g4SimHits.cfi"
    replace g4SimHits.UseMagneticField       = false  
    # replace g4SimHits.G4Commands ={"/tracking/verbose 1"}
    replace g4SimHits.Physics.type = "SimG4Core/Physics/QGSP"
    replace g4SimHits.Physics.DefaultCutValue = 0.07
    replace g4SimHits.StackingAction.SaveFirstLevelSecondary = true
    # Replace all of the ECAL sensitive detector configuration
    replace g4SimHits.ECalSD = {
	bool   UseBirkLaw = false
	double BirkC1 = 0.0045
	double BirkC2 = 0.
	double BirkC3 = 1.
	bool   BirkL3Parametrization = false
	double BirkSlope = 0.253694
	double BirkCut   = 0.10
	double SlopeLightYield = 0.0
	untracked bool TestBeam = false
        bool doCherenkov = false
        untracked bool ReadBothSide = false
    }
    
    module analyzer = XtalDedxAnalysis {
        InputTag caloHitSource = g4SimHits:HcalHits
        double   EnergyMax   = 200.0
    }
    
    path p1 = { VtxSmeared, g4SimHits, analyzer }
    endpath outpath = { o1 }
}		
